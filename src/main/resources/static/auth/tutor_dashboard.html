<!-- <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Tutor Dashboard</title>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f5f7fa;
      color: #333;
    }

    header {
      background-color: #2196F3;
      padding: 20px;
      text-align: center;
      color: white;
      font-size: 24px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .container {
      max-width: 1000px;
      margin: 30px auto;
      background: white;
      padding: 30px;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }

    h2 {
      margin-top: 0;
      color: #2196F3;
    }

    .actions {
      display: flex;
      gap: 20px;
      margin-bottom: 30px;
    }

    .actions button {
      flex: 1;
      padding: 15px;
      font-size: 16px;
      background-color: #2196F3;
      border: none;
      color: white;
      border-radius: 6px;
      cursor: pointer;
      transition: background 0.2s;
    }

    .actions button:hover {
      background-color: #1976D2;
    }

    .quiz-list {
      margin-top: 20px;
    }

    .quiz-item {
      padding: 15px;
      margin-bottom: 10px;
      background-color: #f0f0f0;
      border-radius: 6px;
      transition: 0.2s;
    }

    .quiz-item:hover {
      background-color: #e0f7fa;
      cursor: pointer;
    }

    .logout {
      margin-top: 30px;
      text-align: right;
    }

    .logout button {
      padding: 10px 20px;
      background: #f44336;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }

    .logout button:hover {
      background: #d32f2f;
    }

    @media (max-width: 600px) {
      .actions {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>

<header>
  Tutor Dashboard
</header>

<div class="container">
  <h2>Welcome, Tutor üëã</h2>

  <div class="actions">
    <button onclick="createQuestion()">‚ûï Create Question</button>
    <button onclick="createQuiz()">üìù Create Quiz</button>
  </div>

  <h2>Your Quizzes</h2>
  <div class="quiz-list">
    <div class="quiz-item">Java Basics Quiz - 10 Questions</div>
    <div class="quiz-item">Data Structures Quiz - 8 Questions</div>
    <div class="quiz-item">Web Development Quiz - 12 Questions</div>
  </div>

  <div class="logout">
    <button onclick="logout()">Logout</button>
  </div>
</div>

<script>
  function createQuestion() {
    alert("Redirect to create-question page");
    // window.location.href = "/create-question";
  }

  function createQuiz() {
    alert("Redirect to create-quiz page");
    // window.location.href = "/create-quiz";
  }

  function logout() {
    alert("Logging out...");
    window.location.href = "/";
  }
</script>

</body>
</html> -->


<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Tutor Dashboard</title>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f5f7fa;
      color: #333;
    }

    header {
      background-color: #2196F3;
      padding: 20px;
      text-align: center;
      color: white;
      font-size: 24px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .container {
      max-width: 1000px;
      margin: 30px auto;
      background: white;
      padding: 30px;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }

    h2 {
      margin-top: 0;
      color: #2196F3;
    }

    .actions {
      display: flex;
      gap: 20px;
      margin-bottom: 30px;
    }

    .actions button {
      flex: 1;
      padding: 15px;
      font-size: 16px;
      background-color: #2196F3;
      border: none;
      color: white;
      border-radius: 6px;
      cursor: pointer;
      transition: background 0.2s;
    }
    
    .actions button.secondary {
        background-color: #6c757d;
    }

    .actions button:hover {
      background-color: #1976D2;
    }
    
    .actions button.secondary:hover {
        background-color: #5a6268;
    }

    .quiz-list {
      margin-top: 20px;
    }

    .quiz-item {
      padding: 15px;
      margin-bottom: 10px;
      background-color: #f0f0f0;
      border-radius: 6px;
      transition: 0.2s;
    }

    .quiz-item:hover {
      background-color: #e0f7fa;
      cursor: pointer;
    }

    .logout {
      margin-top: 30px;
      text-align: right;
    }

    .logout button {
      padding: 10px 20px;
      background: #f44336;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }

    .logout button:hover {
      background: #d32f2f;
    }
    
    #output {
        margin-top: 20px; 
        background-color: #ffebee; 
        color: #c62828; 
        padding: 15px; 
        border-radius: 5px; 
        display: none; 
        border: 1px solid #ef9a9a;
        white-space: pre-wrap;
    }

    @media (max-width: 600px) {
      .actions {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>

<header>
  Tutor Dashboard
</header>

<div class="container">
  <h2>Welcome, Tutor üëã</h2>

  <div class="actions">
    <button onclick="createQuestion()">‚ûï Create Question</button>
    <button onclick="createQuiz()">üìù Create Quiz</button>
    <!-- NEW BUTTON ADDED HERE -->
    <button onclick="viewStudentDashboard()" class="secondary">üßë‚Äçüéì View Student Dashboard</button>
  </div>

  <h2>Your Quizzes</h2>
  <div class="quiz-list">
    <div class="quiz-item">Java Basics Quiz - 10 Questions</div>
    <div class="quiz-item">Data Structures Quiz - 8 Questions</div>
    <div class="quiz-item">Web Development Quiz - 12 Questions</div>
  </div>

  <div class="logout">
    <button onclick="logout()">Logout</button>
  </div>
  
  <!-- DIV TO SHOW ERROR MESSAGES -->
  <div id="output"></div>
</div>

<script>
  function createQuestion() {
    alert("Redirect to create-question page");
    // window.location.href = "/create-question";
  }

  function createQuiz() {
    alert("Redirect to create-quiz page");
    // window.location.href = "/create-quiz";
  }

  // NEW FUNCTION ADDED HERE
  async function viewStudentDashboard() {
    // Retrieve the token from session storage
    const token = window.firebaseToken;
    const outputDiv = document.getElementById('output');
    outputDiv.style.display = 'none'; // Hide previous errors

    if (!token) {
        outputDiv.innerText = "Authentication token not found. Please log in again.";
        outputDiv.style.display = 'block';
        return;
    }

    try {
        const redirectResponse = await fetch("http://localhost:8080/api/student/get", {
            method: 'GET',
            headers: {
                // Use the retrieved token for authorization
                'Authorization': 'Bearer ' + token
            }
        });

        if (redirectResponse.ok) {
            const html = await redirectResponse.text();
            // This part will likely not be reached due to security rules,
            // but it's here for completeness.
            document.documentElement.innerHTML = html;
            
            // Re-add the token to session storage in the new page context
            const script = document.createElement('script');
            script.text = `sessionStorage.setItem('firebaseToken', '${token}');`;
            document.body.appendChild(script);

            // Update the URL in the address bar
            history.pushState(null, '', redirectResponse.url);

        } else {
            // Display an error if the fetch fails (e.g., 403 Forbidden)
            outputDiv.innerText = `Request failed: ${redirectResponse.status} ${redirectResponse.statusText}.\nThis is expected. A Tutor does not have permission to view the Student dashboard.`;
            outputDiv.style.display = 'block';
        }
    } catch (err) {
        outputDiv.innerText = "An error occurred: " + err.message;
        outputDiv.style.display = 'block';
    }
  }

  function logout() {
    // Clear the token from session storage on logout
    sessionStorage.removeItem('firebaseToken');
    alert("Logging out...");
    window.location.href = "/";
  }
</script>

</body>
</html>
